-- Top salesperson with how much commission earned 


SELECT `Salesperson`, CONCAT('$', FORMAT(SUM(`Commission Earned`), 2)) as `Total_Commission`
FROM `Car Sales Data`.`car_sales_data`
GROUP BY `Salesperson`
ORDER BY SUM(`Commission Earned`) DESC
Limit 1;


-- removed the duplicate names in the file to get the correct number 

SELECT 
    TRIM(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
    REPLACE(REPLACE(`Salesperson`, ' MD', ''), ' Jr.', ''), ' PhD', ''), 
    ' DDS', ''), ' DVM', ''), ' II', ''), ' III', ''), ' Mr.', ''), ' Dr.', '')) 
    AS Cleaned_Salesperson, 
    FORMAT(SUM(`Commission Earned`), 2) AS Total_Commission
FROM `Car Sales Data`.`car_sales_data`
GROUP BY Cleaned_Salesperson
ORDER BY SUM(`Commission Earned`) DESC,
Limit 1;

-- to check if the newly cleaned table shows the same answers (it does match it) 

SELECT `Cleaned_Salesperson`, CONCAT('$', FORMAT(SUM(`Commission Earned`), 2)) as `Total_Commission`
FROM `Car Sales Data`.`cleaned_car_sales_data`
GROUP BY `Cleaned_Salesperson`
ORDER BY SUM(`Commission Earned`) DESC;
